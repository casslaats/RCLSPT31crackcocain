function replaceFace(){ctracker.init(pModel),getVideo(),ctracker.start(videoInput),drawLoop()}function drawLoop(){positions=ctracker.getCurrentPosition();var e=document.getElementById("drawCanvas"),t=e.getContext("2d");requestAnimationFrame(drawLoop);var a=positions[1];console.log(a);var i=positions[13],o=positions[27],n=positions[32],r=positions[44],s=positions[50],d=positions[41];t.clearRect(0,0,e.width,e.height),t.strokeStyle="#FF000F",t.beginPath(),t.moveTo(r[0],r[1]),t.lineTo(s[0],s[1]),t.closePath(),t.stroke(),t.strokeStyle="#91FF00",t.beginPath(),t.moveTo(o[0],o[1]),t.lineTo(n[0],n[1]),t.closePath(),t.stroke(),distanceMouth=lineDistance(r[0],r[1],s[0],s[1]);var p=document.getElementById("templeDistance");p.innerHTML=distanceMouth,distanceEyes=lineDistance(o[0],o[1],n[0],n[1]);var c=document.getElementById("eyeDistance");c.innerHTML=distanceEyes;var h=document.getElementById("TOTAL");shapeValue=getAverageValue(distanceMouth/distanceEyes),h.innerHTML=shapeValue,timer++,400==timer&&(shapeChoice=getShape(shapeValue)),1==graphicSwitch&&("square"==shapeChoice?drawShape(shapeChoice,d[0],d[1],lineDistance(a[0],a[1],i[0],i[1])):"triangle"==shapeChoice?drawShape(shapeChoice,d[0],d[1],lineDistance(a[0],a[1],i[0],i[1])):"circle"==shapeChoice&&drawShape(shapeChoice,d[0],d[1],lineDistance(a[0],a[1],i[0],i[1])))}function getVideo(){if(navigator.getUserMedia=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia||navigator.msGetUserMedia,window.URL=window.URL||window.webkitURL||window.msURL||window.mozURL,navigator.getUserMedia){var e={video:!0};if(window.navigator.appVersion.match(/Chrome\/(.*?) /)){var t=parseInt(window.navigator.appVersion.match(/Chrome\/(\d+)\./)[1],10);20>t&&(e="video")}navigator.getUserMedia(e,function(e){videoInput.mozCaptureStream?videoInput.mozSrcObject=e:videoInput.src=window.URL&&window.URL.createObjectURL(e)||e,videoInput.play()},function(){alert("We weren't able to find your webcam, maybe your mexican druglord stole it?")})}else alert("Your browser doesn't support getUserMedia :( sorry bro!")}function lineDistance(e,t,a,i){var o=0;if(t==i)o=a-e;else{var n=Math.abs(i-t),r=Math.abs(a-e),s=n*n+r*r;o=Math.sqrt(s)}return o}function getAverageValue(e){averageValue.unshift(e),averageValue=averageValue.slice(0,1e3);for(var t=0,a=0;a<averageValue.length;a++)t+=averageValue[a];return t/=averageValue.length}function getShape(e){return shapeReturn="",graphicSwitch=!0,.7>e?shapeReturn="triangle":e>=.7&&.85>e?shapeReturn="square":e>=.85?shapeReturn="circle":void 0}function drawShape(e,t,a,i){var o=800,n=600,r=45,s=o/n,d=.1,p=1e4,c=$("#container"),h=new THREE.PerspectiveCamera(r,s,d,p),l=new THREE.Scene;l.add(h),h.position.z=720,renderer.setSize(o,n),c.append(renderer.domElement);var u=new THREE.MeshLambertMaterial({color:13369344}),g=i,v=16,w=16;if("circle"==e){var m=new THREE.Mesh(new THREE.SphereGeometry(g,v,w),u);m.position.x=t-400,a>=300&&(m.position.y=-Math.abs(a)+300),150==a&&(m.position.y=a),a>150&&300>a&&(m.position.y=300-a),150>a&&(m.position.y=300-a),rotation+=.01,m.rotation.y=rotation,m.rotation.x=rotation,l.add(m)}else if("square"==e){var y=new THREE.Mesh(new THREE.BoxGeometry(i,i,i),u);y.position.x=t-400,a>=300&&(y.position.y=-Math.abs(a)+300),150==a&&(y.position.y=a),a>150&&300>a&&(y.position.y=300-a),150>a&&(y.position.y=300-a),rotation+=.01,y.rotation.y=rotation,y.rotation.x=rotation,l.add(y)}else if("triangle"==e){var E=new THREE.Mesh(new THREE.TetrahedronGeometry(g,detail),u);E.position.x=t-400,a>=300&&(E.position.y=-Math.abs(a)+300),150==a&&(E.position.y=a),a>150&&300>a&&(E.position.y=300-a),150>a&&(E.position.y=300-a),rotation+=.01,E.rotation.y=rotation,E.rotation.x=rotation,l.add(E)}var M=new THREE.PointLight(16777215);M.position.x=10,M.position.y=200,M.position.z=230,l.add(M),renderer.render(l,h)}var videoInput=document.getElementById("inputVideo"),positions,distanceMouth,i=0,ctracker=new clm.tracker({useWebGL:!0}),averageValue=[],shapeValue=0,timer=0,shapeChoice,graphicSwitch=!1,renderer=new THREE.WebGLRenderer({alpha:!0}),shapeReturn,rotation=0;